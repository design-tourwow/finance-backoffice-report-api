<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seed Database - 54566_image_test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    
    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    
    .info-box {
      background: #f0f4ff;
      border-left: 4px solid #667eea;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .info-box strong {
      color: #667eea;
    }
    
    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .btn:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-danger {
      background: #e74c3c;
    }
    
    .btn-danger:hover {
      background: #c0392b;
    }
    
    .log-container {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 6px;
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
    }
    
    .log-success { color: #4ec9b0; }
    .log-error { color: #f48771; }
    .log-warning { color: #dcdcaa; }
    .log-info { color: #9cdcfe; }
    
    .progress-bar {
      width: 100%;
      height: 30px;
      background: #f0f0f0;
      border-radius: 15px;
      overflow: hidden;
      margin: 20px 0;
      display: none;
    }
    
    .progress-bar.active {
      display: block;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 0%;
      transition: width 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 12px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üå± Seed Database</h1>
    <p class="subtitle">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Tour Image Manager</p>
    
    <div class="info-box">
      <strong>Instance:</strong> 54566_image_test<br>
      <strong>API Key:</strong> b9746df17c49ee50175db1c7b2b0cb843d5267c0ce25fdb36f7fe041c9784a99
    </div>
    
    <div>
      <button class="btn" onclick="seedAll()">üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      <button class="btn" onclick="seedCountries()">üìç ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</button>
      <button class="btn" onclick="seedImages()">üñºÔ∏è ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
      <button class="btn btn-danger" onclick="clearLog()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á Log</button>
    </div>
    
    <div class="progress-bar" id="progressBar">
      <div class="progress-fill" id="progressFill">0%</div>
    </div>
    
    <div class="log-container" id="logContainer">
      <div class="log-info">üìù ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
    </div>
  </div>

  <script>
    const API_BASE_URL = 'https://api.nocodebackend.com';
    const INSTANCE_ID = '54566_image_test';
    const API_KEY = 'b9746df17c49ee50175db1c7b2b0cb843d5267c0ce25fdb36f7fe041c9784a99';
    
    let countryIds = [];
    
    // Sample data
    const countries = [
      { name: '‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô' },
      { name: '‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ' },
      { name: '‡πÑ‡∏ó‡∏¢' },
      { name: '‡∏à‡∏µ‡∏ô' },
      { name: '‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô' }
    ];
    
    const images = [
      { file_name: '‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü‡∏ü‡∏π‡∏à‡∏¥-1', file_path: 'https://images.unsplash.com/photo-1490806843957-31f4c9a91c65?w=600', country_index: 0 },
      { file_name: 'Osaka-castle-‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡πÇ‡∏≠‡∏ã‡∏≤‡∏Å‡πâ‡∏≤', file_path: 'https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=600', country_index: 0 },
      { file_name: 'Tokyo-Tower-‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß‡∏ó‡∏≤‡∏ß‡πÄ‡∏ß‡∏≠‡∏£‡πå', file_path: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=600', country_index: 0 },
      { file_name: 'Kyoto-Temple-‡∏ß‡∏±‡∏î‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß‡πÇ‡∏ï', file_path: 'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=600', country_index: 0 },
      { file_name: 'Shibuya-Crossing-‡∏ä‡∏¥‡∏ö‡∏π‡∏¢‡πà‡∏≤', file_path: 'https://images.unsplash.com/photo-1542051841857-5f90071e7989?w=600', country_index: 0 },
      
      { file_name: 'Seoul-Tower-‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡πÇ‡∏ã‡∏•', file_path: 'https://images.unsplash.com/photo-1517154421773-0529f29ea451?w=600', country_index: 1 },
      { file_name: 'Gyeongbokgung-Palace-‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ß‡∏±‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏ö‡∏Å', file_path: 'https://images.unsplash.com/photo-1583417319070-4a69db38a482?w=600', country_index: 1 },
      { file_name: 'Busan-Beach-‡∏´‡∏≤‡∏î‡∏õ‡∏π‡∏ã‡∏≤‡∏ô', file_path: 'https://images.unsplash.com/photo-1578193661550-3d0e9a2a0f6e?w=600', country_index: 1 },
      { file_name: 'Jeju-Island-‡πÄ‡∏Å‡∏≤‡∏∞‡πÄ‡∏ä‡∏à‡∏π', file_path: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=600', country_index: 1 },
      { file_name: 'Myeongdong-Shopping-‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏°‡∏µ‡∏¢‡∏á‡∏î‡∏á', file_path: 'https://images.unsplash.com/photo-1601024445121-e5b82f020549?w=600', country_index: 1 },
      
      { file_name: 'Grand-Palace-‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', file_path: 'https://images.unsplash.com/photo-1563492065599-3520f775eeed?w=600', country_index: 2 },
      { file_name: 'Phuket-Beach-‡∏´‡∏≤‡∏î‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', file_path: 'https://images.unsplash.com/photo-1589394815804-964ed0be2eb5?w=600', country_index: 2 },
      { file_name: 'Chiang-Mai-Temple-‡∏ß‡∏±‡∏î‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', file_path: 'https://images.unsplash.com/photo-1552465011-b4e21bf6e79a?w=600', country_index: 2 },
      { file_name: 'Ayutthaya-Historical-Park-‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', file_path: 'https://images.unsplash.com/photo-1528181304800-259b08848526?w=600', country_index: 2 },
      { file_name: 'Floating-Market-‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡πâ‡∏≥', file_path: 'https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?w=600', country_index: 2 },
      
      { file_name: 'Great-Wall-‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏à‡∏µ‡∏ô', file_path: 'https://images.unsplash.com/photo-1508804185872-d7badad00f7d?w=600', country_index: 3 },
      { file_name: 'Shanghai-Skyline-‡πÄ‡∏ã‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏Æ‡πâ', file_path: 'https://images.unsplash.com/photo-1474181487882-5abf3f0ba6c2?w=600', country_index: 3 },
      { file_name: 'Forbidden-City-‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ß‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏°', file_path: 'https://images.unsplash.com/photo-1547981609-4b6bfe67ca0b?w=600', country_index: 3 },
      
      { file_name: 'Taipei-101-‡πÑ‡∏ó‡πÄ‡∏õ-101', file_path: 'https://images.unsplash.com/photo-1590559899731-a382839e5549?w=600', country_index: 4 },
      { file_name: 'Taroko-Gorge-‡∏ó‡∏≤‡πÇ‡∏£‡πÇ‡∏Å‡∏∞', file_path: 'https://images.unsplash.com/photo-1562992932-a7b042e9d0c5?w=600', country_index: 4 }
    ];
    
    // Logging functions
    function log(message, type = 'info') {
      const logContainer = document.getElementById('logContainer');
      const timestamp = new Date().toLocaleTimeString('th-TH');
      const logEntry = document.createElement('div');
      logEntry.className = `log-${type}`;
      logEntry.textContent = `[${timestamp}] ${message}`;
      logContainer.appendChild(logEntry);
      logContainer.scrollTop = logContainer.scrollHeight;
    }
    
    function clearLog() {
      document.getElementById('logContainer').innerHTML = '<div class="log-info">üìù Log ‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß...</div>';
    }
    
    function updateProgress(current, total) {
      const progressBar = document.getElementById('progressBar');
      const progressFill = document.getElementById('progressFill');
      const percent = Math.round((current / total) * 100);
      
      progressBar.classList.add('active');
      progressFill.style.width = percent + '%';
      progressFill.textContent = percent + '%';
      
      if (current === total) {
        setTimeout(() => {
          progressBar.classList.remove('active');
        }, 2000);
      }
    }
    
    // API call function
    async function apiCall(endpoint, method = 'GET', data = null) {
      const url = `${API_BASE_URL}${endpoint}?Instance=${INSTANCE_ID}`;
      
      const options = {
        method,
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${API_KEY}`
        }
      };
      
      if (data && (method === 'POST' || method === 'PUT')) {
        options.body = JSON.stringify(data);
      }
      
      const response = await fetch(url, options);
      const result = await response.json();
      
      if (result.status === 'failed') {
        throw new Error(result.error || 'API call failed');
      }
      
      return result;
    }
    
    // Seed countries
    async function seedCountries() {
      log('üìç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®...', 'info');
      countryIds = [];
      
      for (let i = 0; i < countries.length; i++) {
        try {
          const result = await apiCall('/create/countries', 'POST', countries[i]);
          countryIds.push(result.id);
          log(`‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®: ${countries[i].name} (ID: ${result.id})`, 'success');
          updateProgress(i + 1, countries.length);
          await sleep(300);
        } catch (error) {
          log(`‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® ${countries[i].name}: ${error.message}`, 'error');
        }
      }
      
      log(`üéâ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! (${countryIds.length}/${countries.length})`, 'success');
      return countryIds;
    }
    
    // Seed images
    async function seedImages() {
      if (countryIds.length === 0) {
        log('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏Å‡πà‡∏≠‡∏ô!', 'warning');
        return;
      }
      
      log('üñºÔ∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...', 'info');
      let successCount = 0;
      
      for (let i = 0; i < images.length; i++) {
        try {
          const imageData = {
            file_name: images[i].file_name,
            file_path: images[i].file_path,
            country_id: countryIds[images[i].country_index],
            updated_at: new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000).toISOString()
          };
          
          const result = await apiCall('/create/images', 'POST', imageData);
          successCount++;
          log(`‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ${images[i].file_name} (ID: ${result.id})`, 'success');
          updateProgress(i + 1, images.length);
          await sleep(300);
        } catch (error) {
          log(`‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ${images[i].file_name}: ${error.message}`, 'error');
        }
      }
      
      log(`üéâ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! (${successCount}/${images.length})`, 'success');
    }
    
    // Seed all
    async function seedAll() {
      log('üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...', 'info');
      
      try {
        await seedCountries();
        await sleep(1000);
        await seedImages();
        log('‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!', 'success');
      } catch (error) {
        log(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, 'error');
      }
    }
    
    // Helper function
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
  </script>
</body>
</html>
